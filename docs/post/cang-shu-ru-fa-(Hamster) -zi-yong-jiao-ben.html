<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />
    <script src='https://blog.meekdai.com/Gmeek/plugins/GmeekVercount.js'></script>
    <link rel="icon" href="https://github.githubassets.com/favicons/favicon.svg"><script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
<meta name="description" content="## BigModelTranslator.js

```javascript
// author: å™ç™½
// date: 2025-07-30
// name: BigModelTranslator.js
// æ³¨æ„ï¼šè¯·åœ¨è„šæœ¬ä¸­çš„å˜é‡åŠŸèƒ½ä¸­æ·»åŠ  bigmodel_key å˜é‡ï¼Œå€¼ä¸º BigModel çš„ API Key
// ä½¿ç”¨glm-4.5-airx ï¼Œå¯æ›¿æ¢ä¸ºglm-4.5-flash å…è´¹æ¨¡å‹ï¼Œé»˜è®¤å…³é—­æ€è€ƒ

const BASE_URL = 'https://open.bigmodel.cn/api/paas/v4/chat/completions';
const DEFAULT_MODEL = 'glm-4.5-airx';
const DEFAULT_TEMPERATURE = 0.8;

/**
 * ä¸»å‡½æ•°ï¼Œç”¨äºå¤„ç†è¾“å…¥å¹¶è¾“å‡ºç¿»è¯‘ç»“æœ
 */
async function output() {
  var text = $searchText || $pasteboardContent;
  if (!text) {
    return '';
  }
  return await bigModelTranslate(text);
}

/**
 * è°ƒç”¨ BigModel ç¿»è¯‘ API
 * @param {string} text - éœ€è¦ç¿»è¯‘çš„æ–‡æœ¬
 * @returns {Promise<string>} - ç¿»è¯‘åçš„æ–‡æœ¬
 */
async function bigModelTranslate(text) {
  const messages = [
    {
      role: 'system',
      content: `ä½ æ˜¯ä¸€ä¸ªä¸­è‹±ç¿»è¯‘ä¸“ï¼Œèƒ½ç¿»è¯‘å¾—å‡†ç¡®æ˜“æ‡‚ï¼Œå¯¹å„ç§ä¸“ä¸šæœ¯è¯­éƒ½èƒ½å‡†ç¡®ç¿»è¯‘ï¼Œä½†æ˜¯å¯¹äºä¸ç†è§£çš„æœ¯è¯­è¯·ä¿æŒåŸæ–‡ã€‚">
<meta property="og:title" content="ä»“è¾“å…¥æ³•(Hamster) è‡ªç”¨è„šæœ¬">
<meta property="og:description" content="## BigModelTranslator.js

```javascript
// author: å™ç™½
// date: 2025-07-30
// name: BigModelTranslator.js
// æ³¨æ„ï¼šè¯·åœ¨è„šæœ¬ä¸­çš„å˜é‡åŠŸèƒ½ä¸­æ·»åŠ  bigmodel_key å˜é‡ï¼Œå€¼ä¸º BigModel çš„ API Key
// ä½¿ç”¨glm-4.5-airx ï¼Œå¯æ›¿æ¢ä¸ºglm-4.5-flash å…è´¹æ¨¡å‹ï¼Œé»˜è®¤å…³é—­æ€è€ƒ

const BASE_URL = 'https://open.bigmodel.cn/api/paas/v4/chat/completions';
const DEFAULT_MODEL = 'glm-4.5-airx';
const DEFAULT_TEMPERATURE = 0.8;

/**
 * ä¸»å‡½æ•°ï¼Œç”¨äºå¤„ç†è¾“å…¥å¹¶è¾“å‡ºç¿»è¯‘ç»“æœ
 */
async function output() {
  var text = $searchText || $pasteboardContent;
  if (!text) {
    return '';
  }
  return await bigModelTranslate(text);
}

/**
 * è°ƒç”¨ BigModel ç¿»è¯‘ API
 * @param {string} text - éœ€è¦ç¿»è¯‘çš„æ–‡æœ¬
 * @returns {Promise<string>} - ç¿»è¯‘åçš„æ–‡æœ¬
 */
async function bigModelTranslate(text) {
  const messages = [
    {
      role: 'system',
      content: `ä½ æ˜¯ä¸€ä¸ªä¸­è‹±ç¿»è¯‘ä¸“ï¼Œèƒ½ç¿»è¯‘å¾—å‡†ç¡®æ˜“æ‡‚ï¼Œå¯¹å„ç§ä¸“ä¸šæœ¯è¯­éƒ½èƒ½å‡†ç¡®ç¿»è¯‘ï¼Œä½†æ˜¯å¯¹äºä¸ç†è§£çš„æœ¯è¯­è¯·ä¿æŒåŸæ–‡ã€‚">
<meta property="og:type" content="article">
<meta property="og:url" content="https://xubai-owo.github.io/post/cang-shu-ru-fa-%28Hamster%29%20-zi-yong-jiao-ben.html">
<meta property="og:image" content="https://github.githubassets.com/favicons/favicon.svg">
<title>ä»“è¾“å…¥æ³•(Hamster) è‡ªç”¨è„šæœ¬</title>



</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}

</style>




<body>
    <div id="header">
<h1 class="postTitle">ä»“è¾“å…¥æ³•(Hamster) è‡ªç”¨è„šæœ¬</h1>
<div class="title-right">
    <a href="https://xubai-owo.github.io" id="buttonHome" class="btn btn-invisible circle" title="é¦–é¡µ">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/xubai-owo/xubai-owo.github.io/issues/2" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="åˆ‡æ¢ä¸»é¢˜">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><h2>BigModelTranslator.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// date: 2025-07-30
// name: BigModelTranslator.js
// æ³¨æ„ï¼šè¯·åœ¨è„šæœ¬ä¸­çš„å˜é‡åŠŸèƒ½ä¸­æ·»åŠ  bigmodel_key å˜é‡ï¼Œå€¼ä¸º BigModel çš„ API Key
// ä½¿ç”¨glm-4.5-airx ï¼Œå¯æ›¿æ¢ä¸ºglm-4.5-flash å…è´¹æ¨¡å‹ï¼Œé»˜è®¤å…³é—­æ€è€ƒ

const BASE_URL = "https://open.bigmodel.cn/api/paas/v4/chat/completions";
const DEFAULT_MODEL = "glm-4.5-airx";
const DEFAULT_TEMPERATURE = 0.8;

/**
 * ä¸»å‡½æ•°ï¼Œç”¨äºå¤„ç†è¾“å…¥å¹¶è¾“å‡ºç¿»è¯‘ç»“æœ
 */
async function output() {
  var text = $searchText || $pasteboardContent;
  if (!text) {
    return "";
  }
  return await bigModelTranslate(text);
}

/**
 * è°ƒç”¨ BigModel ç¿»è¯‘ API
 * @param {string} text - éœ€è¦ç¿»è¯‘çš„æ–‡æœ¬
 * @returns {Promise&lt;string&gt;} - ç¿»è¯‘åçš„æ–‡æœ¬
 */
async function bigModelTranslate(text) {
  const messages = [
    {
      role: "system",
      content: `ä½ æ˜¯ä¸€ä¸ªä¸­è‹±ç¿»è¯‘ä¸“ï¼Œèƒ½ç¿»è¯‘å¾—å‡†ç¡®æ˜“æ‡‚ï¼Œå¯¹å„ç§ä¸“ä¸šæœ¯è¯­éƒ½èƒ½å‡†ç¡®ç¿»è¯‘ï¼Œä½†æ˜¯å¯¹äºä¸ç†è§£çš„æœ¯è¯­è¯·ä¿æŒåŸæ–‡ã€‚`,
    },
    {
      role: "user",
      content: `è¯·ä½ åªç»™å‡ºç¿»è¯‘åçš„æ–‡æœ¬ï¼Œä¸è¦æœ‰å¤šä½™çš„æ–‡æœ¬ï¼Œæˆ‘è¦ç¿»è¯‘çš„æ–‡æœ¬æ˜¯ï¼š ${text}`,
    },
  ];

  try {
    const response = await $http({
      url: BASE_URL,
      method: "POST",
      header: {
        "Content-Type": "application/json",
        Authorization: `Bearer ${$bigmodel_key}`,
      },
      body: {
        messages,
        model: DEFAULT_MODEL,
        temperature: DEFAULT_TEMPERATURE,
        top_p: 0.1,
        max_tokens: 2048,
				thinking: {
        "type": "disabled",
    },
      },
      timeout: 30,
    });

    if (response.response.statusCode !== 200) {
      throw new Error(`APIè¯·æ±‚å¤±è´¥: HTTPçŠ¶æ€ç  ${response.response.statusCode}`);
    }

    const responseData = JSON.parse(response.data);
    if (!responseData.choices || responseData.choices.length === 0) {
      throw new Error("APIè¿”å›æ•°æ®æ ¼å¼é”™è¯¯: æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„å›å¤");
    }

    // è¿”å›ç¿»è¯‘åçš„å†…å®¹
    return responseData.choices[0].message?.content || "";
  } catch (error) {
    const errorMessage =
      error instanceof SyntaxError
        ? "APIè¿”å›çš„æ•°æ®æ— æ³•è§£æä¸ºJSON"
        : error.message || "æœªçŸ¥é”™è¯¯";
    $log(`BigModel API é”™è¯¯: ${errorMessage}`);
    if (error.response) {
      $log(`å“åº”è¯¦æƒ…: ${JSON.stringify(error.response)}`);
    }
    return `æŠ±æ­‰ï¼Œå‘ç”Ÿäº†é”™è¯¯: ${errorMessage}`;
  }
}
</code></pre>
<h2>DeepSeek.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// date: 2025-07-16
// name: DeepSeek.js
// æ³¨æ„ï¼šè¯·åœ¨è„šæœ¬ä¸­çš„å˜é‡åŠŸèƒ½ä¸­æ·»åŠ  deepseek_key å˜é‡ï¼Œå€¼ä¸º DeepSeek çš„ API Key
// å¦‚æœæ‚¨ä½¿ç”¨è½¬å‘å¹³å°çš„ API ï¼Œåˆ™å€¼ä¸ºè½¬å‘å¹³å°çš„ API Key, å¹¶ä¸”ä¿®æ”¹ BASE_URL
// æ­¤è„šæœ¬å…¼å®¹ OpenAI æ ¼å¼ (openai, deepseek, kimi ç­‰)

const BASE_URL = "https://api.deepseek.com/v1/chat/completions";
const MODEL = "deepseek-chat";
const TEMPERATURE = 1.3; // é€šç”¨å¯¹è¯æ¨èæ¸©åº¦
try {
  API_KEY = $deepseek_key;
} catch (ReferenceError) {
  API_KEY = null;
}

async function deepseekDemo(question) {
  // å‚æ•°éªŒè¯
  if (API_KEY == null) {
    return "æœªè·å–åˆ°api keyï¼Œè¯·åœ¨è„šæœ¬é¡µé¢å³ä¸Šé¢å˜é‡é¡µé¢æ·»åŠ deepseek_keyå˜é‡ï¼Œå€¼ä¸ºdeepseekå¹³å°æä¾›çš„api key"
  }

  if (!question || typeof question !== 'string') {
    return 'æ— æ•ˆçš„æé—®å†…å®¹';
  }

  isShortAnswer = !question.endsWith('-');
  const systemPrompt = `ä½ æ˜¯ä¸€ä½AIåŠ©æ‰‹ï¼Œèƒ½å¤Ÿå›ç­”çš„ä¸“ä¸šä»¥åŠå‡†ç¡®${isShortAnswer ? "ï¼Œç°åœ¨è¯·å°½é‡ç”¨ä¸€å¥è¯å›ç­”æˆ‘çš„é—®é¢˜" : ""}`;

  const messages = [
    { role: "system", content: systemPrompt },
    { role: "user", content: question }
  ];

  const response = await $http({
    url: BASE_URL,
    method: "POST",
    header: {
      "Content-Type": "application/json",
      Authorization: `Bearer ${API_KEY}`,
    },
    body: {
      messages: messages,
      model: MODEL,
      temperature: TEMPERATURE
    },
    timeout: 30,
  });

  // å¤„ç†HTTPå¼‚å¸¸çŠ¶æ€ç 
  if (response.response.statusCode != 200) {
    let errorMessage = `APIè¯·æ±‚å¤±è´¥ (HTTP ${response.response.statusCode})`;

    // å°è¯•è§£æé”™è¯¯è¯¦æƒ…
    try {
      const errorData = JSON.parse(response.data);
      if (errorData.error?.message) {
        errorMessage += `: ${errorData.error.message}`;
      } else {
        errorMessage += ` - ${JSON.stringify(errorData)}`;
      }
    } catch (parseError) {
      errorMessage += ` - åŸå§‹å“åº”: ${response.data}`;
    }

    $log(`HTTPé”™è¯¯: ${errorMessage}`);
    return `è¯·æ±‚å¤±è´¥: ${errorMessage}`;
  }

  // è§£æJSONå“åº”
  let responseData;
  try {
    responseData = JSON.parse(response.data);
  } catch (parseError) {
    const errorMessage = `å“åº”æ•°æ®è§£æå¤±è´¥: ${response.data}`;
    $log(`JSONè§£æé”™è¯¯: ${errorMessage}`);
    return `æ”¶åˆ°ä¸å¯è§£æçš„å“åº”æ•°æ®`;
  }


  // éªŒè¯å“åº”ç»“æ„
  if (!responseData.choices || !Array.isArray(responseData.choices) ||
    responseData.choices.length === 0) {
    const errorMessage = `æ— æ•ˆçš„å“åº”æ ¼å¼: ${JSON.stringify(responseData)}`;
    $log(errorMessage);
    return 'æ”¶åˆ°æ— æ•ˆçš„å“åº”æ•°æ®';
  }

  const content = responseData.choices[0].message?.content;
  if (!content) {
    $log(`å“åº”ä¸­ç¼ºå°‘å†…å®¹å­—æ®µ: ${JSON.stringify(responseData)}`);
    return 'æœªæ”¶åˆ°æœ‰æ•ˆçš„å›å¤å†…å®¹';
  }

  return content;


}

async function output() {
  // è¾“å…¥ä¼˜å…ˆçº§ï¼šæœç´¢æ¡† &gt; å‰ªè´´æ¿
  const question = $searchText || $pasteboardContent;

  return await deepseekDemo(question);
}
</code></pre>
<h2>Deeplx.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// date: 2024-09-25
// name: Deeplx.js
// æ³¨æ„: éœ€æ·»åŠ å˜é‡deeplx_key
// ä½¿ç”¨ï¼š è¦ç¿»è¯‘æˆè‹±æ–‡æˆ–ä¸­æ–‡ï¼Œåœ¨ç¿»è¯‘æ–‡æœ¬å‰åŠ â€œä¸­/è‹±â€ï¼Œ ä¾‹ï¼š ä¸­æˆ‘è¦å›å®¶ï¼Œå°†ä¼šç¿»è¯‘æˆè‹±æ–‡

async function output() {
  const text = $searchText || $pasteboardContent;
  if (!text) return null; // æ£€æŸ¥è¾“å…¥æ˜¯å¦ä¸ºç©º

  const langMap = {
    "ä¸­": "ZH",
    "è‹±": "EN"
  };

  const target = langMap[text[0]]; // æ ¹æ®é¦–å­—ç¬¦æ˜ å°„è¯­è¨€
  if (!target) return null; // å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°å¯¹åº”è¯­è¨€ï¼Œç›´æ¥è¿”å›

  const payload = {
    text: text.slice(1),
    source_lang: "auto",
    target_lang: target
  };

  try {
    const response = await $http({
      url: `https://api.deeplx.org/${$deeplx_key}/translate`,
      method: 'POST',
      header: { 'Content-Type': 'application/json' },
      body: payload,
    });

    if (response.response.statusCode !== 200) {
      return "è¯·æ±‚å¤±è´¥";
    }

    return JSON.parse(response.data).data;
  } catch (error) {
    $log(error);
    return null;
  }
}
</code></pre>
<h2>Deeplxä¸­å¤–äº’è¯‘.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// date: 2024-09-28
// name: Deeplxä¸­å¤–äº’è¯‘.js
// æ³¨æ„: éœ€æ·»åŠ å˜é‡deeplx_key
// ä½¿ç”¨ï¼š è¦ç¿»è¯‘æˆè‹±æ–‡æˆ–ä¸­æ–‡ï¼Œåœ¨ç¿»è¯‘æ–‡æœ¬å‰åŠ â€œä¸­/è‹±â€ï¼Œ ä¾‹ï¼š ä¸­æˆ‘è¦å›å®¶ï¼Œå°†ä¼šç¿»è¯‘æˆè‹±æ–‡

async function output() {
  const text = $searchText || $pasteboardContent || "æµ‹è¯•æ–‡æœ¬";
  if (!text) return "è¯·è¾“å…¥è¦ç¿»è¯‘çš„æ–‡æœ¬"; // æ£€æŸ¥è¾“å…¥æ˜¯å¦ä¸ºç©º


  let target = await detectLang(text); // è‡ªåŠ¨æ£€æµ‹è¯­è¨€å¹¶ç¿»è¯‘
  let translatedText = await translate(text, target); // ç¿»è¯‘æ–‡æœ¬
  return translatedText;
  
}

async function detectLang(text) {
  try {
    const url = `https://translate.googleapis.com/translate_a/single?client=gtx&amp;sl=auto&amp;tl=auto&amp;dt=t&amp;q=${encodeURIComponent(text)}`;
		// ç¬¬ä¸€æ¬¡è°ƒç”¨ googleTranslate å‡½æ•°ï¼Œæ£€æµ‹å¹¶ç¿»è¯‘æ–‡æœ¬
    const resp = await $http({
      url,
      header: {"Content-Type": "application/json"}
      });

    if (resp.response.statusCode !== 200) {
      return "ç¿»è¯‘å¤±è´¥";
    }

    const jsonDict = JSON.parse(resp.data);
    const detectedLang = jsonDict[2]; // è¿™ä¸ªå­—æ®µåŒ…å«æ£€æµ‹åˆ°çš„æºè¯­è¨€

    // æ ¹æ®æ£€æµ‹åˆ°çš„æºè¯­è¨€å†³å®šç›®æ ‡è¯­è¨€
    let targetLang = detectedLang === "zh-CN" ? "EN" : "ZH";
    return targetLang;
  } catch (error) {
    throw new Error(error);
  }
}

async function translate(text, target) {
  const payload = {
    text: text,
    source_lang: "auto",
    target_lang: target
  };

  try {
    const response = await $http({
      url: `https://api.deeplx.org/${$deeplx_key}/translate`,
      method: 'POST',
      header: { 'Content-Type': 'application/json' },
      body: payload,
    });

    if (response.response.statusCode !== 200) {
      return "è¯·æ±‚å¤±è´¥";
    }
    $log(response.data);
    return JSON.parse(response.data).data;
  } catch (error) {
    $log(error);
    return null;
  }
}
</code></pre>
<h2>Gemini.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// date: 2024-10-03
// name: Gemini.js
// æ³¨æ„ï¼šè¯·åœ¨è„šæœ¬ä¸­çš„å˜é‡åŠŸèƒ½ä¸­æ·»åŠ  gemini_key å˜é‡ï¼Œå€¼ä¸º Gemini çš„ API Key

const BASE_URL = "https://generativelanguage.googleapis.com/v1beta/models";
const DEFAULT_MODEL = "gemini-1.5-flash";

async function geminiDemo(question = "ä½ å¥½", options = {}) {
  const {
    model = DEFAULT_MODEL,
    isShortAnswer = question.endsWith('-')
  } = options;

  const systemPrompt = `ä½ æ˜¯ä¸€ä½AIåŠ©æ‰‹ï¼Œèƒ½å¤Ÿå›ç­”çš„ä¸“ä¸šä»¥åŠå‡†ç¡®${isShortAnswer ? "ï¼Œç°åœ¨è¯·å°½é‡ç”¨ä¸€å¥è¯å›ç­”æˆ‘çš„é—®é¢˜" : ""}`;

  const url = `${BASE_URL}/${model}:generateContent?key=${$gemini_key}`;
  const body = {
    'system_instruction': {
      'parts': {
        'text': systemPrompt
      }
    },
    'contents': {
      'parts': {
        'text': question
      }
    }
  };

  try {
    const resp = await $http({
      url,
      method: "post",
      header: {
        "Content-Type": "application/json"
      },
      body: body,
      timeout: 30,
    });

    const statusCode = resp.response.statusCode;
    if (statusCode !== 200) {
      throw new Error(`APIè¯·æ±‚å¤±è´¥: HTTPçŠ¶æ€ç  ${statusCode}`);
    }

    const parsedData = JSON.parse(resp.data);
    if (!parsedData.candidates || parsedData.candidates.length === 0) {
      throw new Error('APIè¿”å›æ•°æ®æ ¼å¼é”™è¯¯: æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„å›å¤');
    }

    return parsedData.candidates[0].content.parts[0].text || "";
  } catch (error) {
    let errorMessage = 'æœªçŸ¥é”™è¯¯';
    if (error instanceof SyntaxError) {
      errorMessage = 'APIè¿”å›çš„æ•°æ®æ— æ³•è§£æä¸ºJSON';
    } else if (error.message) {
      errorMessage = error.message;
    }
    $log(`Gemini API é”™è¯¯: ${errorMessage}`);
    if (error.response) {
      $log(`å“åº”è¯¦æƒ…: ${JSON.stringify(error.response)}`);
    }
    return `æŠ±æ­‰ï¼Œå‘ç”Ÿäº†é”™è¯¯: ${errorMessage}`;
  }
}

async function output() {
  const question = $searchText || $pasteboardContent || "ä½ å¥½-";
  return await geminiDemo(question);
}
</code></pre>
<h2>Qwen-MT-Turbo.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½ (modified for Qwen-MT-Turbo)
// date: 2025-07-25
// name: Qwen-MT-Turbo.js
// æ³¨æ„ï¼šè¯·åœ¨å˜é‡åŠŸèƒ½ä¸­æ·»åŠ  dashscope_key å˜é‡ï¼Œå€¼ä¸ºé˜¿é‡Œäº‘ DashScope çš„ API Key

const BASE_URL = "https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions";
const MODEL = "qwen-mt-turbo";
const TEMPERATURE = 0.7;

try {
  API_KEY = $dashscope_key;
} catch (ReferenceError) {
  API_KEY = null;
}

// è¯­è¨€æ£€æµ‹å‡½æ•°ï¼šä½¿ç”¨ Google Translate API è‡ªåŠ¨è¯†åˆ«è¯­è¨€
async function detectLang(text) {
  try {
    const url = `https://translate.googleapis.com/translate_a/single?client=gtx&amp;sl=auto&amp;tl=auto&amp;dt=t&amp;q=${encodeURIComponent(text)}`;
    const resp = await $http({
      url,
      header: { "Content-Type": "application/json" }
    });

    if (resp.response.statusCode !== 200) {
      throw new Error("Google Translate è¯·æ±‚å¤±è´¥");
    }

    const jsonDict = JSON.parse(resp.data);
    const detectedLang = jsonDict[2]; // æ£€æµ‹åˆ°çš„è¯­è¨€ä»£ç 

    // åˆ¤æ–­ç›®æ ‡è¯­è¨€
    return detectedLang === "zh-CN" ? "English" : "Chinese";
  } catch (error) {
    throw new Error("è¯­è¨€æ£€æµ‹å¤±è´¥ï¼š" + error.message);
  }
}

// ä¸»ç¿»è¯‘å‡½æ•°ï¼šè°ƒç”¨ Qwen-MT-Turbo æ¨¡å‹è¿›è¡Œç¿»è¯‘
async function translateWithQwen(text) {
  if (!text || typeof text !== 'string') {
    return 'æ— æ•ˆçš„è¾“å…¥å†…å®¹';
  }

  if (API_KEY == null) {
    return "æœªè·å–åˆ° API Keyï¼Œè¯·åœ¨å˜é‡é¡µé¢æ·»åŠ  dashscope_key";
  }

  let targetLang;
  try {
    targetLang = await detectLang(text);
  } catch (err) {
    return err.message;
  }

  const response = await $http({
    url: BASE_URL,
    method: "POST",
    header: {
      "Content-Type": "application/json",
      "Authorization": `Bearer ${API_KEY}`
    },
    body: {
      model: MODEL,
      messages: [{ role: "user", content: text }],
      temperature: TEMPERATURE,
      translation_options: {
        source_lang: "auto",
        target_lang: targetLang
      }
    },
    timeout: 30
  });

  // å¤„ç† HTTP é”™è¯¯çŠ¶æ€ç 
  if (response.response.statusCode !== 200) {
    let errorMessage = `API è¯·æ±‚å¤±è´¥ (HTTP ${response.response.statusCode})`;
    try {
      const errorData = JSON.parse(response.data);
      if (errorData.error?.message) {
        errorMessage += `: ${errorData.error.message}`;
      } else {
        errorMessage += ` - ${JSON.stringify(errorData)}`;
      }
    } catch (parseError) {
      errorMessage += ` - åŸå§‹å“åº”: ${response.data}`;
    }
    $log(`HTTP é”™è¯¯: ${errorMessage}`);
    return `è¯·æ±‚å¤±è´¥: ${errorMessage}`;
  }

  // è§£æå“åº”æ•°æ®
  let responseData;
  try {
    responseData = JSON.parse(response.data);
  } catch (parseError) {
    const errorMessage = `å“åº”æ•°æ®è§£æå¤±è´¥: ${response.data}`;
    $log(`JSON è§£æé”™è¯¯: ${errorMessage}`);
    return `æ”¶åˆ°ä¸å¯è§£æçš„å“åº”æ•°æ®`;
  }

  if (!responseData.choices || !Array.isArray(responseData.choices) || responseData.choices.length === 0) {
    const errorMessage = `æ— æ•ˆçš„å“åº”æ ¼å¼: ${JSON.stringify(responseData)}`;
    $log(errorMessage);
    return 'æ”¶åˆ°æ— æ•ˆçš„å“åº”æ•°æ®';
  }

  const content = responseData.choices[0].message?.content;
  if (!content) {
    $log(`å“åº”ä¸­ç¼ºå°‘å†…å®¹å­—æ®µ: ${JSON.stringify(responseData)}`);
    return 'æœªæ”¶åˆ°æœ‰æ•ˆçš„å›å¤å†…å®¹';
  }

  return content;
}

// è¾“å‡ºä¸»å‡½æ•°
async function output() {
  // è¾“å…¥ä¼˜å…ˆçº§ï¼šæœç´¢æ¡† &gt; å‰ªè´´æ¿
  const text = $searchText || $pasteboardContent;

  return await translateWithQwen(text);
}
</code></pre>
<h2>Unicode.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// name: Unicode.js
// date: 2024-09-26

async function getUnicodeWithCharacter(str) {
    let unicodeArray = [];
    for (let i = 0; i &lt; str.length; i++) {
        let char = str[i];
        let codePoint = str.codePointAt(i);
        
        // Skip the next code unit if this character is a high surrogate
        if (codePoint &gt; 0xFFFF) {
            i++;
        }
        
        let unicode = char + ': U+' + codePoint.toString(16).toUpperCase();
        unicodeArray.push(unicode);
    }
    return unicodeArray.join('\n');
}

async function output() {
  const text = $searchText || $pasteboardContent; 
  const result = await getUnicodeWithCharacter(text);
  return result;
}
</code></pre>
<h2>base64ç¼–ç è§£ç .js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// name: base64ç¼–ç è§£ç .js
// date: 2024-09-25
// ä½¿ç”¨ï¼šEéœ€è¦ç¼–ç çš„å­—ç¬¦ä¸²/Déœ€è¦è§£ç çš„å­—ç¬¦ä¸²

function base64Encode(str) {
  // å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º UTF-8 ç¼–ç 
  const utf8Bytes = unescape(encodeURIComponent(str));
  let output = '';
  let buffer = 0;
  let bitsCollected = 0;

  for (let byte of utf8Bytes) {
    buffer = (buffer &lt;&lt; 8) | byte.charCodeAt(0);
    bitsCollected += 8;

    while (bitsCollected &gt;= 6) {
      bitsCollected -= 6;
      output += 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='[(buffer &gt;&gt; bitsCollected) &amp; 0x3F];
    }
  }


  if (bitsCollected &gt; 0) {
    buffer &lt;&lt;= (6 - bitsCollected);
    output += 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/='[(buffer &amp; 0x3F)];
    output += '='; // æ·»åŠ å¡«å……
  }

  return output;
}

function base64Decode(str) {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';
  let output = '';
  let buffer = 0;
  let bitsCollected = 0;

  for (let char of str) {
    if (char === '=') break;
    const charIndex = chars.indexOf(char);
    if (charIndex === -1) continue; // å¿½ç•¥éæ³•å­—ç¬¦

    buffer = (buffer &lt;&lt; 6) | charIndex;
    bitsCollected += 6;

    while (bitsCollected &gt;= 8) {
      bitsCollected -= 8;
      output += String.fromCharCode((buffer &gt;&gt; bitsCollected) &amp; 0xFF);
    }
  }

  // å°†è§£ç åçš„å­—èŠ‚è½¬æ¢å› UTF-8
  return decodeURIComponent(escape(output));
}

async function output() {
  const text = $searchText || $pasteboardContent
  if (!text) {
    return "è¯·è¾“å…¥å†…å®¹!";
  }
  if (text[0] === "E") {
    return base64Encode(text.slice(1));;
  } else if (text[0] === "D") {
    return base64Decode(text.slice(1));
  } else {
    return "è¯·è¾“å…¥æ­£ç¡®çš„æŒ‡ä»¤";
  }
}
</code></pre>
<h2>bç«™é“¾æ¥è½¬æ¢.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// name: bç«™é“¾æ¥è½¬æ¢.js
// date: 2025-04-17
// ä½¿ç”¨ï¼š å¤åˆ¶bç«™appåˆ†äº«çš„é“¾æ¥åï¼Œè¿è¡Œè„šæœ¬ä¼šè‡ªåŠ¨æå–b23çš„çŸ­é“¾ï¼Œè½¬æ¢ä¸ºåªå«bvå·çš„é•¿é“¾
async function output() {
	var text = $searchText || $pasteboardContent;
	const url = await extractBiliUrls(text);
	$log(url);
	const response = await $http({
		url: `${url}`,
		method: "HEAD"
	});
	const longUrl= response.response.url;
	const shortUrl = longUrl.split('?')[0];
	return shortUrl;
}

function extractBiliUrls(text) {
    // ä¼˜å…ˆåŒ¹é…Bç«™çŸ­é“¾æ¥æ ¼å¼ï¼ˆb23.tvï¼‰
    const biliShortRegex = /https?:\/\/b23\.tv\/[a-zA-Z0-9]+/g;
    const urls = text.match(biliShortRegex) || [];
    
    // è¡¥å……åŒ¹é…æ ‡å‡†URL
    const standardUrls = text.match(/https?:\/\/[^\s]+/g) || [];
    return [...new Set([...urls, ...standardUrls])]; // å»é‡
}
</code></pre>
<h2>getScript.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// name: getScript.js
// date: 2024-09-26

function toRawGitHubLink(url) {
    if (url.includes('github.com') &amp;&amp; url.includes('/blob/')) {
        return url.replace('github.com', 'raw.githubusercontent.com').replace('/blob/', '/');
    }
    return url;
}

async function output() {
    const url = $searchText || $pasteboardContent;
    if (!url) {
        return "è¯·è¾“å…¥url";
    }
    
    const processedUrl = toRawGitHubLink(url);

    try {
        const { data } = await $http({ url: processedUrl });
        return data;
    } catch (error) {
        $log(error);
        return "æœªçŸ¥é”™è¯¯";
    }
}
</code></pre>
<h2>å‘ç—…è¯­å½•.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// name: å‘ç—…è¯­å½•.js
// date: 2024-10-18
// desc: OI api
// author: å™ç™½

async function output() {
	const url = "https://oiapi.net/API/SickL";
	return getMessage(url);
}  

async function getMessage(url) {
	const {data} = await $http({url: url});
	return JSON.parse(data).message;
}
</code></pre>
<h2>å¤šåˆä¸€.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// name: å¤šåˆä¸€.js

async function output() {
  try {
    // ä½¿ç”¨ Promise.all å¹¶è¡Œæ‰§è¡Œæ‰€æœ‰å¼‚æ­¥å‡½æ•°
    const results = await Promise.all([
      tiangou(),
      yiyan(),
      yulu(),
      fkxqs(),
      dujitang(),
      tapped()
    ]);

    // éå†ç»“æœå¹¶è¾“å‡º
    let resulList = [];
    results.forEach((result, index) =&gt; {
      resulList.push(result);
    });

    return resulList;
  } catch (error) {
    $log(error);
    throw error;
  }
}

async function tiangou() {
  let tg = await $http({
    method: "GET",
    url: "https://api.oick.cn/dog/api.php",
    header: {
      site: "https://api.oick.cn"
    }
  });
  return tg.data;
}

async function yiyan() {
  let yy = await $http({
    method: "GET",
    url: "https://v1.hitokoto.cn/?c=f&amp;encode=text",
    header: {
      site: "www.shadiao.app"
    }
  });
  return yy.data;
}

//ç¤¾ä¼šäºº
async function yulu(){
  let tw = await $http({url: "https://api.oick.cn/yulu/api.php"});
  return tw.data;
};

//ç–¯ç‹‚æ˜ŸæœŸå››
async function fkxqs() {
  let aa = await $http({
    method: "GET",
    url: "https://api.shadiao.pro/kfc",});
  
  return JSON.parse(aa.data).data.text;
};

//æ¯’é¸¡æ±¤
async function dujitang() {
  let aa = await $http({
    method: "GET",
    url: "https://api.shadiao.pro/du",});
  return JSON.parse(aa.data).data.text;
};

//éª‚äºº
async function tapped() {
  let aa = await $http({
    method: "GET",
    url: "https://yyapi.a1aa.cn/api.php?level=max",});
    return aa.data;
};
</code></pre>
<h2>å­—ç¬¦ä¸²è½¬utf8æ•°ç»„.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// name: å­—ç¬¦ä¸²è½¬utf8æ•°ç»„.js
// å·¥å…·ç±»å‡½æ•°

function stringToUTF8Bytes(str) {
    const utf8 = [];
    for (let i = 0; i &lt; str.length; i++) {
        let charCode = str.charCodeAt(i);
        if (charCode &lt; 0x80) {
            utf8.push(charCode);
        } else if (charCode &lt; 0x800) {
            utf8.push(0xc0 | (charCode &gt;&gt; 6), 0x80 | (charCode &amp; 0x3f));
        } else if (charCode &lt; 0x10000) {
            utf8.push(0xe0 | (charCode &gt;&gt; 12), 0x80 | ((charCode &gt;&gt; 6) &amp; 0x3f), 0x80 | (charCode &amp; 0x3f));
        } else {
            utf8.push(
                0xf0 | (charCode &gt;&gt; 18),
                0x80 | ((charCode &gt;&gt; 12) &amp; 0x3f),
                0x80 | ((charCode &gt;&gt; 6) &amp; 0x3f),
                0x80 | (charCode &amp; 0x3f)
            );
        }
    }
    return utf8;
}

async function output(){
	const utf8Array = stringToUTF8Bytes("ä½ å¥½");
$log(utf8Array);
}
</code></pre>
<h2>æ–°é—».js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// name: æ–°é—».js
// date: 2024-11-04
// author: å™ç™½

async function output() {
	let url = "http://api.suxun.site/api/sixs?type=json";
	return await getData(url);
	
}

async function getData(url) {
	const { data } = await $http({url: url});
	const jsonData = JSON.parse(data);
	let news = jsonData.news;
	return news;
}
</code></pre>
<h2>æœ‰é“ç¿»è¯‘.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// by leepyer
// å™ç™½ä¿®æ”¹é€‚é…ä»“è¾“å…¥æ³•
async function output() {
  try {
    var text = $searchText || $pasteboardContent;
    if (!text) {
      return "è¯·è¾“å…¥è¦ç¿»è¯‘çš„æ–‡æœ¬";
    }
    const url = "https://m.youdao.com/translate";
    const params = {
      "inputtext": text,
      "type": "auto"
    };
    const headers = {
      "Content-Type": "application/x-www-form-urlencoded",
      "Referer": "https://m.youdao.com/translate"
    };
    const resp = await $http({
      url,
      method: "POST",
      body: params,
      header: headers
    });
    const regex = /&lt;ul id="translateResult"&gt;[\s\S]*?&lt;\/ul&gt;/;
    let match = resp.data.match(regex);
    let result = match ? match[0] : null;
    const reg = /(?&lt;=&lt;li&gt;).*(?=&lt;\/li&gt;)/;
    // const reg = /&lt;li&gt;(.*?)&lt;\/li&gt;/;
    const m = result.match(reg);
    const res = m ? m[0] : null;
    // const res = m ? m[1] : null;
    return res;
  } catch (error) {
    $log(error);
    return null;
  }
}
</code></pre>
<h2>æ¯æ—¥æ²¹ä»·.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// name: æ¯æ—¥æ²¹ä»·.js
// data: 2024-10-18
// author: å™ç™½
// desc: è‡ªè¡Œè®¾ç½®ä½ éœ€è¦çš„çœä»½

async function output() {
	// çœä»½åè‡ªè¡Œæ›¿æ¢
	return await getOilPrice("å¹¿ä¸œçœ");
}

async function getOilPrice(regionName) {
	const url = "https://v2.api-m.com/api/oilPrice"
	const {data} = await $http({url: url});
	const jsonData = JSON.parse(data);
	const region = jsonData.data.filter(item =&gt; item.regionName === regionName)[0];
	const prices = [
  `92æ±½æ²¹: ${region.n92}å…ƒ`,
  `95æ±½æ²¹: ${region.n95}å…ƒ`,
  `98æ±½æ²¹: ${region.n98}å…ƒ`,
  `0å·æŸ´æ²¹: ${region.n0}å…ƒ`
];
  return prices;

	
}
</code></pre>
<h2>æ±‡ç‡.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// name: æ±‡ç‡.js
// data: 2024-09-26
// ä½¿ç”¨: ä¸åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ•°å­—ï¼Œç›´æ¥ç‚¹å‡»æŒ‰é’®ï¼Œåˆ™é»˜è®¤è½¬æ¢ä¸º 1 åŸºå‡†è´§å¸ å…‘ å…¶ä»–è´§å¸æ±‡ç‡ã€‚
// è¾“å…¥æ¡†ä¸­è¾“å…¥æ•°å­—ï¼Œåˆ™è½¬æ¢ä¸ºè¾“å…¥æ•°å­— åŸºå‡†è´§å¸ å…‘ å…¶ä»–è´§å¸æ±‡ç‡ã€‚
const currencyNames = {
  cny: ["äººæ°‘å¸", "ğŸ‡¨ğŸ‡³"],
  usd: ["ç¾å…ƒ", "ğŸ‡ºğŸ‡¸"],
  hkd: ["æ¸¯å¸", "ğŸ‡­ğŸ‡°"],
  jpy: ["æ—¥å…ƒ", "ğŸ‡¯ğŸ‡µ"],
  eur: ["æ¬§å…ƒ", "ğŸ‡ªğŸ‡º"],
  gbp: ["è‹±é•‘", "ğŸ‡¬ğŸ‡§"],
};
let defaultBaseCurrency = "cny"; // å…¨å±€è®¾ç½®åŸºå‡†è´§å¸

// å¼‚æ­¥å‡½æ•°æ¥å¤„ç†æ±‡ç‡è½¬æ¢
async function output() {
  let text = $searchText;
  const precision = 4; // ä¿ç•™å°æ•°
  
  // æ£€æµ‹å¹¶æå–è¾“å…¥çš„æ•°å­—å’ŒåŸºå‡†è´§å¸
  const { amount, baseCurrency } = extractAmountAndCurrency(text) || { amount: 1, baseCurrency: defaultBaseCurrency };

  const exchangeData = await getCurrencyData(baseCurrency);

  const result = formatExchangeRates(exchangeData, baseCurrency, amount, precision);
  return result;
}

function extractAmountAndCurrency(text) {
  if (!text) return { amount: 1, baseCurrency: defaultBaseCurrency }; // é»˜è®¤å€¼å¤„ç†

  // åŒ¹é…æ•°å­—ï¼ˆå¯ä»¥æ˜¯å°æ•°ï¼‰å’Œè´§å¸ä»£ç æˆ–åç§°
  const regex = /(\d+(\.\d+)?)\s*([a-zA-Z]+|[\u4e00-\u9fa5]+)?/;
  const match = text.match(regex);

  if (match) {
    const amount = parseFloat(match[1]);
    const currencyText = match[3]?.toLowerCase();

    // å¦‚æœåŒ¹é…åˆ°è´§å¸ç§ç±»ï¼Œè¿”å›å¯¹åº”çš„è´§å¸ï¼Œå¦åˆ™ä½¿ç”¨é»˜è®¤åŸºå‡†è´§å¸
    if (currencyText) {
      for (const [currency, [name]] of Object.entries(currencyNames)) {
        if (currency === currencyText || name.includes(currencyText)) {
          return { amount, baseCurrency: currency };
        }
      }
    }

    // æ²¡æœ‰åŒ¹é…åˆ°è´§å¸æ—¶ï¼Œä½¿ç”¨å…¨å±€é»˜è®¤çš„åŸºå‡†è´§å¸
    return { amount, baseCurrency: defaultBaseCurrency };
  }

  return { amount: 1, baseCurrency: defaultBaseCurrency };
}

async function getCurrencyData(baseCurrency) {
  const url = `https://cdn.jsdelivr.net/npm/@fawazahmed0/currency-api@latest/v1/currencies/${baseCurrency}.json`;
  try {
      const resp = await $http({ url: url, method: 'GET' });
      const jsonData = JSON.parse(resp.data);
      return jsonData;
  } catch (error) {
      $log(error);
      return null;
  }
}

// æ ¼å¼åŒ–æ±‡ç‡è½¬æ¢çš„é€»è¾‘ï¼Œå¢åŠ  amount å‚æ•°
function formatExchangeRates(data, baseCurrency, amount = 1, precision = 4) {
  const result = [];

  // è·å–åŸºå‡†è´§å¸å¯¹å…¶ä»–è´§å¸çš„æ±‡ç‡
  const baseRates = data[baseCurrency];

  if (!baseRates || !currencyNames[baseCurrency]) {
    return `åŸºå‡†è´§å¸ ${baseCurrency} ä¸å­˜åœ¨æˆ–æ— æ•ˆ`;
  }

  const [baseCurrencyName, baseFlag] = currencyNames[baseCurrency];

  // éå†æœ¬åœ° currencyNames
  for (const [currency, [foreignCurrencyName, foreignFlag]] of Object.entries(currencyNames)) {
    if (currency === baseCurrency) {
      continue; // è·³è¿‡åŸºå‡†è´§å¸
    }

    const rate = baseRates[currency];
    if (rate) {
      const convertedAmount = (amount * rate).toFixed(precision);
      result.push(`${amount} ${baseCurrencyName} ${baseFlag} å…‘ ${convertedAmount} ${foreignCurrencyName} ${foreignFlag}`);
    }
  }
  return result;
}
</code></pre>
<h2>çƒ­æœ.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// name: çƒ­æœ.js
// date: 2024-10-17
// author: å™ç™½
// desc: æ¥è‡ªé¾™ç api

async function output() {
	// zhihu(çŸ¥ä¹çƒ­æ¦œ)weibo(å¾®åšçƒ­æœ) baidu(ç™¾åº¦çƒ­ç‚¹)history(å†å²ä¸Šçš„ä»Šå¤©)bilihot(å“”å“©å“”å“©çƒ­æœ)biliall(å“”å“©å“”å“©å…¨ç«™æ—¥æ¦œ)douyin(æŠ–éŸ³çƒ­æœ)
	// typeåæ›¿æ¢ä¸Šé¢è¿™äº›è·å–ä¸åŒçš„çƒ­æœ
	const url = "https://www.hhlqilongzhu.cn/api/rs_juhe.php?type=douyin"
	return getTrending(url);

}

async function getTrending(url) {
	const {data} = await $http({url: url});
	const dataList = JSON.parse(data).data;
	
	const titles = dataList.map(item =&gt; item.title);
	return titles;
}
</code></pre>
<h2>è°·æ­Œä¸­è‹±äº’è¯‘.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// name: è°·æ­Œä¸­è‹±äº’è¯‘.js
// date: 2024-09-27

async function googleTranslate(text) {
  try {
    const url = `https://translate.googleapis.com/translate_a/single?client=gtx&amp;sl=auto&amp;tl=auto&amp;dt=t&amp;q=${encodeURIComponent(text)}`;
		// ç¬¬ä¸€æ¬¡è°ƒç”¨ googleTranslate å‡½æ•°ï¼Œæ£€æµ‹å¹¶ç¿»è¯‘æ–‡æœ¬
    const resp = await $http({
      url,
      header: {"Content-Type": "application/json"}
      });

    if (resp.response.statusCode !== 200) {
      return "ç¿»è¯‘å¤±è´¥";
    }

    const jsonDict = JSON.parse(resp.data);
    const detectedLang = jsonDict[2]; // è¿™ä¸ªå­—æ®µåŒ…å«æ£€æµ‹åˆ°çš„æºè¯­è¨€

    // æ ¹æ®æ£€æµ‹åˆ°çš„æºè¯­è¨€å†³å®šç›®æ ‡è¯­è¨€
    let targetLang = detectedLang === "zh-CN" ? "en" : "zh-CN";

    // è¿›è¡Œç¬¬äºŒæ¬¡ç¿»è¯‘ï¼Œè¿™æ¬¡ä½¿ç”¨ç›®æ ‡è¯­è¨€
    const urlWithTarget = `https://translate.googleapis.com/translate_a/single?client=gtx&amp;sl=${detectedLang}&amp;tl=${targetLang}&amp;dt=t&amp;q=${encodeURIComponent(text)}`;
    const respWithTarget = await $http({
      url: urlWithTarget,
      header: {
        "Content-Type": "application/json",
      }
    });

    if (respWithTarget.response.statusCode !== 200) {
      return "ç¿»è¯‘å¤±è´¥";
    }

    const translatedText = JSON.parse(respWithTarget.data)[0].map(item =&gt; item[0]).join('');
    return translatedText;

  } catch (error) {
    $log(error);
    return "ç¿»è¯‘è¿‡ç¨‹ä¸­å‡ºç°é”™è¯¯";
  }
}

async function output() {
  var text = $searchText || $pasteboardContent || "ä½ å¥½";
  if (!text) {
    return "è¯·è¾“å…¥è¦ç¿»è¯‘çš„æ–‡æœ¬";
  }
  
  const translatedText = await googleTranslate(text);
  return translatedText;
}
</code></pre>
<h2>è°·æ­Œç¿»è¯‘.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// author: å™ç™½
// name: è°·æ­Œç¿»è¯‘.js
// date: 2024-09-25
// ä½¿ç”¨ï¼š è¦ç¿»è¯‘æˆè‹±æ–‡æˆ–ä¸­æ–‡ï¼Œåœ¨ç¿»è¯‘æ–‡æœ¬å‰åŠ â€œä¸­/è‹±â€ï¼Œ ä¾‹ï¼š ä¸­æˆ‘è¦å›å®¶ï¼Œå°†ä¼šç¿»è¯‘æˆè‹±æ–‡ 

async function googleTranslate(target, text) {
  try {
    const url = `https://translate.googleapis.com/translate_a/single?client=gtx&amp;sl=auto&amp;tl=${target}&amp;dt=t&amp;q=${encodeURIComponent(text)}`;
    const resp = await $http({
      url,
      header: {
        "Content-Type": "application/json",
      }
    });

    if (resp.response.statusCode!== 200) {
      return "ç¿»è¯‘å¤±è´¥";
    }
    const jsonDict = JSON.parse(resp.data);
    const translatedText = jsonDict[0].map(item =&gt; item[0]).join('');
    return translatedText;

  } catch (error) {
    $log(error);
  }
}

async function output() {
  var text = $searchText || $pasteboardContent || "d l";
  if (!text) {
    return "è¯·è¾“å…¥è¦ç¿»è¯‘çš„æ–‡æœ¬";
  }
  let target = "";
  const languageMap = {
    "ä¸­": "zh-CN",
    "è‹±": "en",
    "éŸ©": "ko",
    "æ—¥": "ja"
    // æ·»åŠ æ›´å¤šè¯­è¨€æ˜ å°„
  };
  target = languageMap[text[0]] || "zh";
  text = text.slice(1);
  const translatedText = await googleTranslate(target, text);
  return translatedText;
}
</code></pre>
<h2>è¿›åˆ¶è½¬æ¢.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// name: è¿›åˆ¶è½¬æ¢.js
// date: 2024-09-29
// è¾“å…¥ä¸¾ä¾‹: äºŒè¿›åˆ¶æ ¼å¼: 0bxxx, 8è¿›åˆ¶æ ¼å¼: 0oxxx, 10è¿›åˆ¶æ ¼å¼: xxx, 16è¿›åˆ¶æ ¼å¼: 0xXXX
// ç»“æœé¡ºåº: 2 8 10 16è¿›åˆ¶

async function output() {
	const inputStr = $searchText;
  const result = convert(inputStr);
  return result;
}

function convert(inputStr) {
    const results = [];

    // åˆ¤æ–­æ•°å­—çš„è¿›åˆ¶
    const base = detectBase(inputStr);

    // å°†æ•°å­—è½¬æ¢ä¸º2, 4, 8, 10, 16è¿›åˆ¶å¹¶å­˜å…¥æ•°ç»„
    if (base !== null) {
        const num = parseInt(inputStr, base);
        results.push(num.toString(2));  // è½¬æ¢æˆ2è¿›åˆ¶
        results.push(num.toString(8));  // è½¬æ¢æˆ8è¿›åˆ¶
        results.push(num.toString(10)); // è½¬æ¢æˆ10è¿›åˆ¶
        results.push(num.toString(16).toUpperCase()); // è½¬æ¢æˆ16è¿›åˆ¶
    } else {
        return "æ— æ³•åˆ¤æ–­è¾“å…¥çš„è¿›åˆ¶æˆ–è¾“å…¥ä¸åˆæ³•ã€‚";
    }

    return results;
}

// åˆ¤æ–­è¾“å…¥æ•°å­—çš„è¿›åˆ¶
function detectBase(str) {
    if (typeof str !== 'string') {
        throw new Error("è¾“å…¥å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹ã€‚");
    }
    // ä½¿ç”¨æ•°ç»„å­˜å‚¨æ­£åˆ™å’Œå¯¹åº”çš„è¿›åˆ¶
    const basePatterns = [
        { pattern: /^0b[01]+$/i, base: 2 },
        { pattern: /^0o[0-7]+$/i, base: 8 },
        { pattern: /^0x[0-9a-f]+$/i, base: 16 },
        { pattern: /^[0-9]+$/, base: 10 }
    ];

    for (const { pattern, base } of basePatterns) {
        if (pattern.test(str)) {
            return base;
        }
    }
    return null;
}
</code></pre>
<h2>éª‚äºº.js</h2>
<pre lang="javascript" class="notranslate"><code class="notranslate">// name: éª‚äºº.js

async function getInsultText(text) {
  try {
    const url = "https://yyapi.a1aa.cn/api.php?level=max";
    

    const resp = await $http({
			url,
      method: 'GET',
      header: { "Content-Type": "application/json" }
    });
    
    // æ£€æŸ¥å“åº”æ˜¯å¦æˆåŠŸ
    if (resp.response.statusCode !== 200) {
      throw new Error(`HTTP error! status: ${resp.response.statusCode}`);
    }

    return resp.data;
  } catch (error) {
    console.error("Translation error:", error);
    return null; // å¤„ç†é”™è¯¯çš„è¿”å›å€¼
  }
}

// ç¤ºä¾‹è°ƒç”¨
async function output() {
 
  const result = await getInsultText();
  return result;
};
</code></pre></div>
<div style="font-size:small;margin-top:8px;float:right;">è½¬è½½è¯·æ³¨æ˜å‡ºå¤„</div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">è¯„è®º</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright Â© <span id="copyrightYear"></span> <a href="https://xubai-owo.github.io">Xubai's Blog</a></div>
<div id="footer2">
    <span id="runday"></span><span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML=now.getFullYear();

if(""!=""){
    var startSite=new Date("");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="ç½‘ç«™è¿è¡Œ"+diffDay+"å¤©"+" â€¢ ";
}
</script></div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z'};
var utterancesLoad=0;

let themeSettings={
    "dark": ["dark","moon","#00f0ff","dark-blue"],
    "light": ["light","sun","#ff5000","github-light"],
    "auto": ["auto","sync","","preferred-color-scheme"]
};
function changeTheme(mode, icon, color, utheme){
    document.documentElement.setAttribute("data-color-mode",mode);
    document.getElementById("themeSwitch").setAttribute("d",value=IconList[icon]);
    document.getElementById("themeSwitch").parentNode.style.color=color;
    if(utterancesLoad==1){utterancesTheme(utheme);}
}
function modeSwitch(){
    let currentMode=document.documentElement.getAttribute('data-color-mode');
    let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
    localStorage.setItem("meek_theme", newMode);
    if(themeSettings[newMode]){
        changeTheme(...themeSettings[newMode]);
    }
}
function utterancesTheme(theme){
    const message={type:'set-theme',theme: theme};
    const iframe=document.getElementsByClassName('utterances-frame')[0];
    iframe.contentWindow.postMessage(message,'https://utteranc.es');
}
if(themeSettings[theme]){changeTheme(...themeSettings[theme]);}
console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);
cmButton=document.getElementById("cmButton");
    span=document.createElement("span");
    span.setAttribute("class","Counter");
    span.innerHTML="3";
    cmButton.appendChild(span);


function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","xubai-owo/xubai-owo.github.io");
    script.setAttribute("issue-term","title");
    
    if(localStorage.getItem("meek_theme")=="dark"){script.setAttribute("theme","dark-blue");}
    else if(localStorage.getItem("meek_theme")=="light") {script.setAttribute("theme","github-light");}
    else{script.setAttribute("theme","preferred-color-scheme");}
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}



</script>
<script src='https://blog.meekdai.com/Gmeek/plugins/articletoc.js'></script>

</html>
